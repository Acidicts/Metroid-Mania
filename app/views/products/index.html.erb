<p style="color: green"><%= notice %></p>
<p style="color: red"><%= alert %></p>

<% content_for :styles do %>
  <style>
    body.products .products-placeholder { display: block; }
  </style>
<% end %>

<h1>Store</h1>

<% if admin? %>
  <%= link_to "New product (Admin)", new_product_path, class: 'btn-retro btn-retro--small' %>
<% end %>

<div id="products" class="products-grid">
  <% @products.each do |product| %>
    <div class="product-card">
      <h3><%= product.name %></h3>
      <p>Cost (Credits): <% if product.cost_in_credits %><%= sprintf('%.2f', product.cost_in_credits) %><% else %><em>from price × ratio</em><% end %></p>

      <%= link_to "Buy Now", new_order_path(product_id: product.id), class: 'btn-retro' %>
      <% if admin? %>
        <div style="margin-top:8px;">
          <%= link_to 'Edit', edit_product_path(product), class: 'btn-retro btn-retro--outline' %>
          <%= link_to 'Delete', product_path(product), method: :delete, data: { confirm: 'Delete this product?' }, class: 'btn-retro btn-retro--danger', style: 'margin-left:6px' %>
        </div>
      <% end %>
      <% if product.variable_grant? %>
        <div style="font-size: 0.9em; margin-top: 6px;"><em>Grant: $<%= sprintf('%.2f', product.grant_min_dollars) %>–$<%= sprintf('%.2f', product.grant_max_dollars) %></em></div>
      <% else %>
        <div style="font-size: 0.9em; margin-top: 6px;"><em>Fixed Item</em></div>
      <% end %>
    </div>
  <% end %>
</div>
