<%= render 'admin/admin_styles' %>

<div class="admin-panel">
  <style>
    .admin-dash-box {
      background-color: var(--accent-2);
      border: 2px dashed var(--main-600);
      padding: 20px;
      margin-top: 20px;
      border-radius: 5px;
      width: 30%;
      margin: 0 1%;
      transition: transform 0.3s ease-in-out;
    }

    .admin-dash-box:hover {
      transform: scale(1.02);
      box-shadow: 0 6px 18px rgba(0,0,0,0.06);
    }

    .admin-dash-box-container {
      display: flex;
      flex-direction: row;
      gap: 20px;
      width: 95%;
    }

    /* align label (strong) and value so all values line up vertically */
    .admin-dash-box p {
      display: grid;
      grid-template-columns: 140px auto; /* adjust 140px to fit longest label */
      column-gap: 12px;
      align-items: center;
      margin: 0.5rem 0;
    }

    /* value badge */
    .admin-dash-box-info {
      display: inline-flex;
      justify-content: flex-end;
      min-width: 3.5rem; /* ensures numeric values line up */
      font-size: 16px;
      font-weight: 700;
      background-color: var(--main-700);
      color: var(--accent3);
      padding: 2px 8px;
      border-radius: 4px;
      text-align: right;
    }

    /* responsive: let label use available space on small screens */
    @media (max-width: 560px) {
      .admin-dash-box p {
        grid-template-columns: 1fr auto;
      }
      .admin-dash-box {
        width: 100%;
      }
    }
  </style>

  <h1>Admin Dashboard</h1>

  <div class="admin-dash-box-container">
    <div class="admin-dash-box">
      <h2>Summary</h2>
      <p><strong>Users:</strong> <%= content_tag :span, @users_count, class: "admin-dash-box-info" %></p>
      <p><strong>Projects:</strong> <%= content_tag :span, @projects_count, class: "admin-dash-box-info" %></p>
      <p><strong>Ships:</strong> <%= content_tag :span, @ships_count, class: "admin-dash-box-info" %></p>
      <p><strong>Orders:</strong> <%= content_tag :span, @orders_count, class: "admin-dash-box-info" %></p>
    </div>

    <div class="admin-dash-box">
      <h2>Projects</h2>
      <p><strong>Projects:</strong> <%= content_tag :span, @projects_count, class: "admin-dash-box-info" %></p>
      <p><strong>Pending:</strong> <%= content_tag :span, @projects_pending_count, class: "admin-dash-box-info" %></p>
      <p><strong>Shipped:</strong> <%= content_tag :span, @ships_count, class: "admin-dash-box-info" %></p>
    </div>

    <div class="admin-dash-box">
      <h2>Orders</h2>
      <p><strong>Orders:</strong> <%= content_tag :span, @orders_count, class: "admin-dash-box-info" %></p>
      <p><strong>Pending:</strong> <%= content_tag :span, @orders_pending_count, class: "admin-dash-box-info" %></p>
      <p><strong>Denied:</strong> <%= content_tag :span, @orders_denied_count, class: "admin-dash-box-info" %></p>
      <p><strong>Fulfilled:</strong> <%= content_tag :span, @orders_fulfilled_count, class: "admin-dash-box-info" %></p>
    </div>
  </div>

  <div style="margin-top: 24px;">
    <h2>Recent Projects</h2>
    <table class="admin-table">
      <thead>
        <tr>
          <th>Project</th>
          <th>Status</th>
          <th>Credits/hr</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% Project.order(created_at: :desc).limit(20).each do |project| %>
          <tr>
            <td><%= project.name %></td>
            <td><%= project.status %></td>
            <td><%= project.credits_per_hour %></td>
            <td>
              <% if project.shipped? %>
                <%= button_to 'Unship', unship_admin_project_path(project), method: :post, class: 'btn-admin btn-admin-warning' %>
              <% else %>
                <%= button_to 'Ship', ship_admin_project_path(project), method: :post, class: 'btn-admin btn-admin-success' %>
                <%= button_to 'Force Ship', force_ship_admin_project_path(project), method: :post, class: 'btn-admin btn-admin-danger' %>
              <% end %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>

</div>
